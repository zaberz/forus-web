import{o as e,c as t,w as l,e as a,r as s,F as i,i as r,a as n,f as o,X as d,D as f,Y as u,Z as c,_ as h,$ as m,z as x,b as k,d as y,p,t as _,H as b,I as g,a0 as w}from"./index-801d5391.js";import{l as v}from"./login.86d01993.js";import"./dayjs.min.d6cfbd8d.js";import{_ as C}from"./_plugin-vue_export-helper.1b428a4d.js";const D=C({name:"feedback",components:{Rate:C({name:"Rate",data:()=>({score:-1}),methods:{change(e){e!=this.score&&(this.score=e,this.$emit("change",e+1))}}},[["render",function(d,f,u,c,h,m){const x=o,k=r;return e(),t(k,{class:"rate-container"},{default:l((()=>[(e(),a(i,null,s(5,(a=>n(k,{key:a,class:"rate-item"},{default:l((()=>[a>h.score?(e(),t(x,{key:0,class:"star-item",src:"/assets/star-ae93e2ad.svg",onClick:e=>m.change(a)},null,8,["onClick"])):(e(),t(x,{key:1,class:"star-item",src:"/assets/star-active-eaa85109.svg",onClick:e=>m.change(a)},null,8,["onClick"]))])),_:2},1024))),64))])),_:1})}],["__scopeId","data-v-7b0d3d24"]])},data:()=>({inited:!1,formInfo:[],formData:{},taskList:[],formDataSchema:[]}),async onLoad(){await this.getFeedbackFormInfo(),this.inited=!0},methods:{inputChangeHandler(e,t){this.formData[t.key]=e.detail.value},radioChangeHandler(e,t){this.formData[t.key]=e.value},checkboxChangeHandler(e,t){this.formData[t.key]=e.value},textareaInputHandler(e,t){this.formData[t.key]=e.detail.value},rateChangeHandler(e,t){this.formData[t.key]=e-1},validate(){for(let e in this.formData)if(""===this.formData[e]){let t=this.formInfo.find((t=>t.key==e));if(t&&t.require)return d({selector:`#${t.key}`,offsetTop:-100}),f({icon:"none",title:`请填写${t.title}`}),!1}return!0},async getFeedbackFormInfo(){let e=await u(),{detail:t}=e;this.formInfo=t;let l={};t.forEach((e=>{let t=e.key;l[t]=""})),this.formData=l},async submitForm(){if(!this.validate())return;let e={...this.formData};Object.keys(this.formData).forEach((t=>{let l=this.formInfo.find((e=>e.key==t));4==l.type&&-1==this.formData[t]&&(e[t]=l.otherValue)}));let t=await async function(){return(await v()).openId}(),l=await v();c({title:"提交中",mask:!0}),await h({...e,phone:l.wxPhone,customer:l.id,openID:t}),f({title:"保存成功"}),setTimeout((()=>{m({url:"/pages/index/index"})}),2e3)},toTaskDetail(e){x({url:`/pages/feedback/progress?id=${e.id}`})}}},[["render",function(o,d,f,u,c,h){const m=r,x=g,v=w,C=p("Rate");return e(),t(m,{class:"page-container"},{default:l((()=>[c.inited?(e(),a(i,{key:0},[n(m,{class:"text-xl"},{default:l((()=>[k("拍摄意见调查")])),_:1}),n(m,{class:"flex justify-between flex-wrap gap-40 text-sm mt-40"},{default:l((()=>[(e(!0),a(i,null,s(c.formInfo,((r,o)=>(e(),a(i,null,[y('          :key="index"'),1==r.type?(e(),t(m,{key:0,class:"text-sm w-320 border-b flex",id:r.key},{default:l((()=>[n(m,{class:"flex-shrink-0"},{default:l((()=>[k(_(r.title)+":",1)])),_:2},1024),n(x,{class:"flex-grow",type:"text",onInput:e=>h.inputChangeHandler(e,r)},null,8,["onInput"])])),_:2},1032,["id"])):y("v-if",!0),7==r.type?(e(),t(m,{key:1,class:"text-sm w-320 border-b flex",id:r.key},{default:l((()=>[n(m,{class:"flex-shrink-0"},{default:l((()=>[k(_(r.title)+":",1)])),_:2},1024),7==r.type?(e(),t(x,{key:0,type:"number",maxlength:"11",onInput:e=>h.inputChangeHandler(e,r)},null,8,["onInput"])):y("v-if",!0)])),_:2},1032,["id"])):y("v-if",!0),2==r.type?(e(),a(i,{key:2},[y("            单选"),n(m,{class:"width-full",id:r.key},{default:l((()=>[n(m,{class:"border-b flex flex-grow width-fill"},{default:l((()=>[n(m,{class:"flex-shrink-0"},{default:l((()=>[k(_(r.title)+":",1)])),_:2},1024)])),_:2},1024),n(m,{class:"flex flex-wrap width-fill"},{default:l((()=>[(e(!0),a(i,null,s(r.options,(a=>(e(),t(m,{onClick:e=>h.radioChangeHandler(a,r),class:"flex item-center w-1_2 flex-grow mt-24"},{default:l((()=>[n(m,{class:b([{active:c.formData[r.key]==a.value},"box border border-solid w-20 h-20 mr-10"])},null,8,["class"]),n(m,null,{default:l((()=>[k(_(a.text),1)])),_:2},1024)])),_:2},1032,["onClick"])))),256))])),_:2},1024)])),_:2},1032,["id"])],64)):y("v-if",!0),3==r.type?(e(),a(i,{key:3},[y("            多选"),n(m,{class:"width-full",id:r.key},{default:l((()=>[n(m,{class:"border-b flex flex-grow width-fill"},{default:l((()=>[n(m,{class:"flex-shrink-0"},{default:l((()=>[k(_(r.title)+":",1)])),_:2},1024)])),_:2},1024),n(m,{class:"flex flex-wrap width-fill"},{default:l((()=>[(e(!0),a(i,null,s(r.options,(a=>(e(),t(m,{onClick:e=>h.checkboxChangeHandler(a,r),class:"flex item-center w-1_2 flex-grow mt-8"},{default:l((()=>[n(m,{class:b([{active:c.formData[r.key]==a.value},"box border border-solid w-20 h-20 mr-10"])},null,8,["class"]),n(m,null,{default:l((()=>[k(_(a.text),1)])),_:2},1024)])),_:2},1032,["onClick"])))),256))])),_:2},1024)])),_:2},1032,["id"])],64)):y("v-if",!0),4==r.type?(e(),a(i,{key:4},[y("            4 == 2 单选"),n(m,{class:"width-full",id:r.key},{default:l((()=>[n(m,{class:"border-b flex flex-grow width-fill"},{default:l((()=>[n(m,{class:"flex-shrink-0"},{default:l((()=>[k(_(r.title)+":",1)])),_:2},1024),n(m,{class:"text-gray-400"},{default:l((()=>[k(_(r.subtitle),1)])),_:2},1024)])),_:2},1024),n(m,{class:"flex flex-wrap width-fill"},{default:l((()=>[(e(!0),a(i,null,s(r.options,(a=>(e(),t(m,{class:"flex item-center w-1_2 flex-grow mt-24",onClick:e=>h.radioChangeHandler(a,r)},{default:l((()=>[n(m,{class:b([{active:c.formData[r.key]==a.value},"box border border-solid w-20 h-20 mr-10"])},null,8,["class"]),n(m,null,{default:l((()=>[k(_(a.text),1)])),_:2},1024)])),_:2},1032,["onClick"])))),256)),n(m,{class:"flex item-center w-1_2 flex-grow mt-24",onClick:e=>h.radioChangeHandler({value:-1},r)},{default:l((()=>[n(m,{class:b([{active:-1==c.formData[r.key]},"box border border-solid w-20 h-20 mr-10"])},null,8,["class"]),n(m,null,{default:l((()=>[k("其他")])),_:1})])),_:2},1032,["onClick"]),-1==c.formData[r.key]?(e(),t(m,{key:0,class:"border border-solid width-fill p-8 mt-8"},{default:l((()=>[n(x,{type:"text",modelValue:r.otherValue,"onUpdate:modelValue":e=>r.otherValue=e},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)):y("v-if",!0)])),_:2},1024)])),_:2},1032,["id"])],64)):y("v-if",!0),5==r.type?(e(),t(m,{key:5,class:"width-full",id:r.key},{default:l((()=>[n(m,{class:"border-b width-fill"},{default:l((()=>[n(m,{class:"flex-shrink-0"},{default:l((()=>[k(_(r.title)+":",1)])),_:2},1024),r.subtitle?(e(),t(m,{key:0,class:"text-gray-400 text-xs"},{default:l((()=>[k(_(r.subtitle),1)])),_:2},1024)):y("v-if",!0)])),_:2},1024),y("              auto-height"),n(v,{style:{height:"270rpx"},onInput:e=>h.textareaInputHandler(e,r)},null,8,["onInput"])])),_:2},1032,["id"])):y("v-if",!0),6==r.type?(e(),t(m,{key:6,class:"width-full",id:r.key},{default:l((()=>[n(m,{class:"border-b flex flex-grow width-fill justify-between"},{default:l((()=>[n(m,{class:"flex-shrink-0"},{default:l((()=>[k(_(r.title)+":",1)])),_:2},1024),n(m,{class:"text-gray-400"},{default:l((()=>[k(_(r.subtitle),1)])),_:2},1024)])),_:2},1024),n(C,{onChange:e=>h.rateChangeHandler(e,r)},null,8,["onChange"])])),_:2},1032,["id"])):y("v-if",!0)],64)))),256))])),_:1}),n(m,{style:{border:"1rpx solid #333","text-align":"center"},onClick:h.submitForm},{default:l((()=>[k("提    交")])),_:1},8,["onClick"]),n(m,{style:{color:"#999999","font-size":"24rpx","text-align":"center","margin-top":"12rpx"}},{default:l((()=>[n(m,null,{default:l((()=>[k(" 提交完成后可通过FORUS官方小程序 登录【我的】账号 查看此次拍摄的后期进度情况哦 ~ ")])),_:1}),n(m,null,{default:l((()=>[k(" （注意需要使用同一手机账号登录哦） ")])),_:1})])),_:1}),n(m,{class:"placeholder",style:{height:"50rpx"}})],64)):y("v-if",!0)])),_:1})}],["__scopeId","data-v-03bc66c6"]]);export{D as default};
