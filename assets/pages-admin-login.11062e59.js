import{a3 as e,D as s,a4 as a,a5 as n,o as i,c as t,w as o,i as l,a as c,b as r,j as d,I as u}from"./index-de1f54a6.js";import{_ as f}from"./_plugin-vue_export-helper.1b428a4d.js";const h=f({name:"login",data:()=>({userInfo:{},hasRegistry:!1}),computed:{},onLoad(e){let{scene:s}=e;this.scene=s,this.init()},methods:{async init(){let s=await login(),a=this.openID=s.openId;console.log(a);let n=await e(a)||{};console.log(n),n.id&&(this.hasRegistry=!0),this.userInfo=n},async doRegistry(){if(!this.userInfo.nickname)return s({title:"请填写姓名",icon:"none"});await a(this.openID,this.userInfo),await this.doLogin()},async doLogin(){await a(this.openID,this.userInfo),await n(this.scene,this.openID),s({title:"登录成功",icon:"success"})}}},[["render",function(e,s,a,n,f,h){const p=l,g=u;return i(),t(p,{class:"page-container"},{default:o((()=>[c(p,{class:"title"},{default:o((()=>[r("正在登陆后台")])),_:1}),c(p,{class:"info"},{default:o((()=>[c(p,null,{default:o((()=>[r("用户名:")])),_:1}),d('      <view v-if="hasRegistry">{{userInfo.nickname}}</view>'),c(g,{type:"nickname",modelValue:f.userInfo.nickname,"onUpdate:modelValue":s[0]||(s[0]=e=>f.userInfo.nickname=e)},null,8,["modelValue"])])),_:1}),f.hasRegistry?(i(),t(p,{key:0,class:"btn",onClick:h.doLogin},{default:o((()=>[r("登陆")])),_:1},8,["onClick"])):(i(),t(p,{key:1,class:"btn",onClick:h.doRegistry},{default:o((()=>[r("注册&登陆")])),_:1},8,["onClick"]))])),_:1})}],["__scopeId","data-v-ee373d87"]]);export{h as default};
